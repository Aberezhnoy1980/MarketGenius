# Работа с сеансами удаленного сервера (VPS)

Необходимо получить файл закрытого ключа (для immers.cloud в разделе Ключевые пары) и имеет формат

`keyname-username.pem`

Изменение прав на файл ключевой пары, с помощью команды 

```SHELL
chmod 600 полный_путь_к_файлу/keyname-userename.pem
```

Запуск сеанса

```SHELL
sudo ssh -i полный_путь_к_файлу/keyname-username.pem -p 22 username@111.11.111.111
```
* username — это название дистрибутива, например, ubuntu
* 111.11.111.111 — IP-адрес Виртуальной машины

## Оптимизация управления удаленным сервером

Редактируем файл конфигурации для удобства соединения:

`vim ./.ssh/config` из домашней директории пользователя (`/Users/<user>`)

необходимо добавить блок записей:

```VIM
Host <host_name>
    HostName <IP or domain_name>
    User <username>
    IdentityFile path_to_file.pem
    Port <port_number>
```

после этого перезагрузить SSH и можно доключаться:

```SHELL
ssh host_name
```

Установка ssl сертификата, корневого сертификата и приватного ключа

1. Собираем общий chain файл crt, последовательно копируя в файл, например, your_domain.cert данные, полученные от провайдера:

```VIM
-----BEGIN CERTIFICATE-----
#Ваш сертификат#
-----END CERTIFICATE-----
-----BEGIN CERTIFICATE-----
#Промежуточный сертификат#
-----END CERTIFICATE-----
-----BEGIN CERTIFICATE-----
#Корневой сертификат#
-----END CERTIFICATE-----
```

2. Отдельно делаем файл ca.crt с корневым мертификатом

3. Приватный ключ можно найти в ЛК провайдера

4. Все файлы копируем на VPS:

```SHELL
scp path_to_file host_name:/path_to_copy
```

Далее настраиваем конфигурацию nginx (при необходимости подключаем volume с ключами к контейнеру docker для nginx)

